# Docker
  
in case of errors: `sudo chmod 666 /var/run/docker.sock`  
  
1. **Container**
    - A **container** is a standars unit of SW that can run a particular app and its associated processes
    - A **container** is **portable** and contains the SW dependencies for a given app
    - It is common to run several containers at once on a single host machine
    - **Containers** are **self-contained** and do not alter the host system they are running on
    - **Docker** is lightweight
    - **Containers** provide **reproducible** and **consistent** environments. If it works in development, it will work in production
    - **Containers** have a smaller footprint than virtual machines
  
    Docker isolates containers from each other. Isolation techniques: cgroups and namespaces  
    Orchestartors can be used to manage multiple containers  
  
    Container vs VM  
    - **Containers** are used for a `single process` or task, while **VM** may run `multiple processes` or tasks
    - **Container** boot times are **much quicker** than VM
  
    Multiple containers on the host machine will always share the kernel of the host machine  

    Docker uses a layered filesystem, so that you can add to a base image  

2. Microservices  
    - Microservices is an architectural style that structures an application as a collection of loosely coupled services
    - Microservices are easier t ofix and test
    - Each microservice can be deployed without the need to deploy the whole app
    - Docker containers are ideal for microservices

3. Containers and images  
    - Images are `blueprints` for containers which then are running instances with read and write access  
    - Containers are separated from each other and have no shared data or state by default  
    - Container is an isolated unit of SW which is based on image. A running instance of that image.  
    - Layers: every instruction in an image creates a cacheable layer - layers help with image re-building and sharing   

4. Attached and detached containers  
    Docker containers can run in two primary modes: attached (foreground) and detached (background).  
    - Attached Mode:  
        - When a Docker container is run in `attached` mode, its standard **input**, **output**, and **error streams** are **connected directly** to the terminal from which it was launched.
        - For `stdin` use `docker run -it <container-id>`
        - Aany output generated by the container's process will be displayed in the terminal, and any input provided to the terminal will be sent to the container.
        - By default, `docker run `starts containers in `attached mode` unless specified otherwise.
        - If the terminal session is closed or the process in the foreground is terminated (e.g., by pressing `Ctrl+C`), the container will typically stop.
    - Detached Mode:  
        - `Detached mode` allows a Docker container to run independently in the **background**, without tying up the terminal session.
        - The `--detach` or `-d` flag is used with docker run to start a container in `detached mode`.
        - When a container is run in `detached mode`, its output is **not displayed** in the launching terminal, but it continues to run as a **background** process.
        - The container's logs can be viewed using `docker logs <container_id_or_name>`.
        - `Detached mode` is suitable for **long-running services** or applications that do not require continuous interaction with the user through the terminal, such as web servers, databases, or background workers. 
    - Attaching to a Detached Container:  
        - It is possible to `attach` to a running `detached` container using the d`ocker attach <container_id_or_name>` command.
        - To `detach` from the container without stopping it, the default key sequence is typically `Ctrl+p` followed by `Ctrl+q`. This sequence can be customized using the `--detach-keys` flag.

5. Copy files to a running container
```
docker cp <local_path> <container_name>:<path_inside_container>    # copy smth to the container
`docker cp <container_name>:<path_inside_container> <local_path>    # copy smth from the container
```



